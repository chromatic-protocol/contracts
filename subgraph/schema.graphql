type AccountCreated @entity(immutable: true) {
  id: Bytes!
  account: Bytes! # address
  owner: Bytes! # address
  blockNumber: BigInt!
  blockTimestamp: BigInt!
  transactionHash: Bytes!
}

type OpenPosition @entity(immutable: true) {
  id: Bytes!
  marketAddress: Bytes! # address
  trader: Bytes! # address
  account: Bytes! # address
  tradingFee: BigInt! # uint256
  tradingFeeUSD: BigInt! # uint256
  blockNumber: BigInt!
  blockTimestamp: BigInt!
  transactionHash: Bytes!
}

type Position @entity(immutable: true) {
  id: ID!
  account: Bytes! # address
  marketAddress: Bytes! # address
  positionId: BigInt!
  qty: BigInt!
  takerMargin: BigInt!
  makerMargin: BigInt!
  tradingFee: BigInt!
  openVersion: BigInt!
  openTimestamp: BigInt!
  closedPosition: ClosedPosition @derivedFrom(field: "position")
  claimedPosition: ClaimedPosition @derivedFrom(field: "position")
}

type ClosedPosition @entity(immutable: true) {
  id: ID!
  position: Position!
  closeVersion: BigInt!
  closeTimestamp: BigInt!
}

type ClaimedPosition @entity(immutable: true) {
  id: ID!
  position: Position!
  entryPrice: BigInt!
  exitPrice: BigInt!
  realizedPnl: BigInt!
  interest: BigInt!
  cause: String!
  blockTimestamp: BigInt!
}